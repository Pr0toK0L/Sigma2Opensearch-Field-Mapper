id: 25b9c01c-350d-4b95-bed1-836d04a4f324
logsource:
  product: linux
title: Potential JAVA JNDI Exploitation Attempt
description: >-
  Identifies an outbound network connection by JAVA to LDAP, RMI or DNS standard
  ports followed by a suspicious JAVA child processes. This may indicate an
  attempt to exploit a JAVA/NDI (Java Naming and Directory Interface) injection
  vulnerability.
tags:
  - attack.auditbeat
  - attack.execution
  - attack.TA0002
  - attack.t1059
  - attack.t1059.007
  - attack.t1023
falsepositives: []
level: high
status: experimental
references: []
author: hoang.nguyen
detection:
  condition: Selection_1 and Selection_2
  Selection_1:
    event.action|all:
      - connection_attempted
    process.name|contains:
      - java
    destination.port|contains:
      - '1389'
      - '389'
      - '1099'
      - '53'
      - '5353'
  Selection_2:
    event.type|all:
      - start
    process.name|all:
      - java
    process.name|contains:
      - sh
      - bash
      - dash
      - ksh
      - tcsh
      - zsh
      - curl
      - perl*
      - python*
      - ruby*
      - php*
      - wget*
